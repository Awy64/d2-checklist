<h2>Vendors -
    <a [routerLink]="['/',currUser.userInfo.membershipType, currUser.userInfo.membershipId]">{{currUser.userInfo.displayName}}
        - {{currUser.userInfo.platformName}}</a>
</h2>
<div class="nav-toggles">

    <mat-button-toggle-group *ngIf="player?.characters" [value]="char$|async" (change)="char$.next($event.value)">
        <mat-button-toggle *ngFor="let c of player.characters" [value]="c">
            {{c.className}}
            <span class="d-none d-md-inline"> - {{c.light}}</span>
        </mat-button-toggle>
    </mat-button-toggle-group>
    <div *ngIf="char$|async as char">{{char.className}}</div>
    <mat-button-toggle-group [value]="options[0]" (change)="option$.next($event.value)">
        <mat-button-toggle *ngFor="let o of options" [value]="o">
            <fa-icon [icon]="o.icon"></fa-icon>
            <span class="d-none d-md-inline"> {{o.text}}</span>
        </mat-button-toggle>
    </mat-button-toggle-group>
    <div *ngIf="option$|async as option">{{option.text}}</div>
    <div>
        <mat-form-field>
            <input matInput #filter placeholder="Filter items">
        </mat-form-field>
        <mat-checkbox class="hide-complete-triumphs" (change)="hideCompleted$.next($event.checked)">
            Hide Completed
        </mat-checkbox>
    </div>
    <div class="center-spinner">
        <mat-spinner class="loading" class="center-spinner" *ngIf="loading"></mat-spinner>
    </div>
    <div *ngIf="!loading">
        <ng-container *ngIf="option$|async as option">
            <table class="tidy-auto-table itemTable" *ngIf="data$|async as data">
                <thead>
                    <tr>
                        <th></th>
                        <th>Name {{data.length}}</th>
                        <th *ngIf="option.text == 'Armor'">Random Stats</th>
                        <th>Vendor</th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngFor="let i of data">
                        <tr>
                            <td>
                                <d2c-item-icon [i]="i" [hideMenu]="true"></d2c-item-icon>
                            </td>
                            <td>
                                <div>{{i.name}}
                                    <span class="secondary-text bold"
                                        *ngIf="i.vendorItemInfo?.quantity>1">({{i.vendorItemInfo.quantity}})</span>
                                </div>
                                <div class="type-caption">{{i.typeName}}</div>
                            </td>
                            <td *ngIf="option.text == 'Armor' && i.type==ItemType.Armor">
                                <div *ngIf="i.preferredStatPoints>0 && i.stats">
                                    <table class="stat-table">
                                        <tbody>
                                            <tr>
                                                <td colspan="2">
                                                    {{i.preferredStatPoints}} / {{i.totalStatPoints}} pref pts
                                                </td>
                                            </tr>
                                            <ng-container *ngFor="let stat of i.stats">
                                                <tr
                                                    *ngIf="preferredStatService.isPreferred(ClassAllowed[i.classAllowed], stat, true)">
                                                    <td>{{stat.name}}</td>
                                                    <td>{{stat.value}}</td>
                                                </tr>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                            <td>
                                <ng-container *ngIf="i.vendorItemInfo as vi">
                                    {{vi.vendor.name}}
                                    <span class="type-caption">Resets in {{ vi.vendor.nextRefreshDate | amDifference:
                                        today
                                        |
                                        amDuration:'ms'}}</span>
                                    <div *ngFor="let c of vi.costs">
                                        <small>{{c.desc.displayProperties.name}} {{c.count}}</small>
                                    </div>
                                    <div *ngIf="vi.status!=null" class="warn-text">
                                        <small>{{vi.status}}</small>
                                    </div>
                                </ng-container>
                            </td>
                        </tr>
                    </ng-container>
                </tbody>
            </table>
        </ng-container>
    </div>
</div>